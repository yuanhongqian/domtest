#  组件开发设计六大原则

----------  

<h2 id="cid_0">原则一：精准地解决共性问题</h2>  

组件来源于应用软件实践中，是对<code>重复、反复出现、普遍的、有相似性</code>的问题进行分析，剥离掉各个问题的特性，而提取各个问题之间的共性。此共性就确定了组件要解决的问题。如果不是共性的问题，那么写完后的代码就只能在一种或有限的几种情况下才能被使用，就无法实现大规模复用。不能广泛地复用，就不能被叫做组件。  

因此，组件首先是<code>业务驱动的，不是技术驱动的</code>。不能因为我们有了新的技术，就想着要写几个新的组件。  

共性的业务问题，是组件的产生来源。  

另外，即使确定了要解决的共性问题，组件也还必须提供解决问题最合理、最有效的方式和方法。如果提供的方法不是最好的，那么也很难得到使用者的喜爱，最终也难以推广和复用。因此，组件设计上，必须提供解决问题的精准思路和方案。这是决定同类别的组件中，哪个组件能胜出的最主要原因。  

**1．技术与业务对齐  **

技术结构和技术概念要与业务上的模型、概念保持一致，在组件对外暴露的接口上，最好不要引入新的技术术语和概念，这样的组件最吻合业务的需求，也最容易理解。
技术与业务对齐，这是组件设计的第一位重要原则。  

**2．技术方案的优势 ** 

这是结构设计、技术选型范畴内要考虑的问题。实现同一个功能，可以有很多不同的结构设计，也可以采用很多不同的技术。优秀的组件，一定要在技术方案上有明显的技术优势。  

**3．接口简单   **

组件暴露出来供外界使用的接口，<code>必须足够简单</code>。在概念和模型层面上与业务保持一致，另外接口封装、抽象上要仔细推敲，保证接口提供给别人使用时，调用者足够简单地使用。  

**4．功能强大 ** 

组件如果提供的功能太少，意味着能帮用户解决的问题比较少，这样的组件实用性大打折扣。而如果组件的功能过多，就会让用户觉得这个组件非常臃肿和庞大，用户只用了其中一小部分功能，其他大部分功能都用不上或者很少用，这样用户要在一本厚厚的使用手册中，仔细寻找自己需要的部分，去除自己不需要的部分，这也算不上一个优秀的组件。因此，一个组件提供的功能，既要能满足多种场景下不同客户的需求，还要在不同的需求中进行取舍和合并，使提供的功能集不会超出客户实际使用需求太多。



 <h2 id="cid_1">原则二：无配置文件</h2>  


<code>组件不带任何配置文件，组件所依赖的各种库也不带任何配置文件。</code> 

这个原则极其重要！！！

如果一个组件，自己定义了配置文件，无论是xml，json，还是其他的文件类型，内部的格式都是组件设计者自己定义的。我们假设一个中等的项目，会使用10个组件，那么就会有10个配置文件。这些配置文件的格式各不相同，那么我们的软件安装手册、维护手册就要仔细描述这10个配置文件的结构，我们的使用者就要学会如何配置这10个文件。如果项目再大，需要集成50个组件，那就需要50个配置文件，对手册编写人员和实施维护人员，这是怎样的灾难啊！

归纳起来，如果一个组件自己带配置文件，带来的不良影响主要有：

1． 不同组件的配置文件格式不统一，软件开发人员、手册编写人员、实施人员、维护人员等要学习不同格式、不同结构、不同的配置方式，学习的成本大大增加；

2．同一个配置（比如数据库连接串，IP地址等），由于各个组件的配置方式不同，则使用者要在多个配置文件中进行配置，既增加了工作量，又难于保证数据始终一致；

3．如果后续发现更好的组件，要用其替换原有的组件，则新的组件的配置文件与原组件的配置文件不同，则即使这两个组件的功能一致，我们也必须更新软件的实施维护手册，相关人员又要重新学习。

因此，基于配置文件的组件，是非常不容易被集成的。一个应用软件，无论其使用多少个组件，应该最多只有一个配置文件，用于集中配置这个应用的所有参数。而每个组件，都是以接口或者类的方式提供配置方法，应用软件集中读取所有配置信息，然后通过组件的配置方法，将配置参数设置到组件上。这样，将从根本上解决组件集成过程中由组件配置文件引起的各种问题


<h2 id="cid_2">原则三：与使用者概念一致</h2>   

给应用组件提供接口。在接口上表现出的概念术语、使用方式都应与使用者的概念术语、使用方式完全对应，也就是说，<code>技术和业务对齐。</code>  

组件设计者常犯的毛病是，组件暴露的接口，引入了新的技术术语，这些术语在使用者的概念体系中根本就不存在，因此使用者理解起来非常困难，造成极大的学习障碍。与使用者概念不一致的技术术语，突出表现在接口<code>命名、类名、方法名、参数名、返回值的含义等</code>。  

从本质上讲，组件接口上暴露的与使用者不一致的概念，要么是这个概念本身就是错误或不恰当的，其不应该存在，要么这是个内部实现的概念，不应该暴露在接口上。


<h2 id="cid_3">原则四：业务无关的中立性</h2>   

一个组件，要在不同应用、不同场景下都能广泛地重用，这是组件设计者必须实现的目标。但一个组件的产生，往往来源于一个特定的项目、一个特定的业务场景，在实现业务和项目功能的时候，组件设计者意识到，这个功能部分可以进行抽取，形成一个可重用的组件。因此，<code>这个抽取的过程，组件设计者务必把与当前这个项目、这个业务特有的部分剥离掉，保留一般、共性的功能，并重新封装和调整接口，以满足通用的使用场景。</code>这样，这个组件可以与业务无关，保持自己的中立性，后续可以在其他的应用中被重用。 

<h2 id="cid_4">原则五：对使用环境无依赖</h2>   

组件的内部实现，是否可以对将来组件被使用的环境做些假设？   

如果组件设计者对组件将来被使用的环境做了一些假设，认为这些条件必然被满足，那么组件的代码实现就会和这些假设条件相关。如果这些条件不成立，则组件无法被使用。比如，组件设计者认为，将来应用中一个组件实例就能满足其需要，因此组件就设计成了单实例。当一个特殊的应用出现，需要使用两个组件实例来处理不同的场景时，发现组件已经被设计成单实例，无法满足应用的这种"特殊"需求。  

这种需求，真的很特殊吗？  

客观上讲，需求来自于具体的应用，来自客户的使用场景和要解决的问题。需求，是独立于设计和实现的，尤其与组件的设计实现无关。组件设计者之所以认为这种需求很"特殊"，是因为这个需求超出了组件设计者原来所做的假设。根本上讲，<code>组件设计者不应该对组件将来的使用环境做任何假设</code>，这样组件的使用场合仅受限于组件的能力集，只要应用需要的功能在组件的能力集范围内，各种环境下的不同应用都可以使用这个组件。
这样，组件才可以被广泛重用。


<h2 id="cid_5">原则六：单类设计和实现</h2>   

怎样的组件，才是一个优秀的组件？从组件使用者的角度，组件要简单，易于使用，并且功能强大。那么组件怎样才能简单，易于使用？  

首先，前面讲过，组件提供出来的接口，要与使用者的概念完全一致，这样使用者就非常容易理解组件的各个类、接口、方法和参数，这样就会易于使用。  

但组件本身怎么才能简单呢？  

最简单的组件，就是一个类。  

一个类，就会比两个类简单，两个类就会比四个类简单。这个道理显而易见，其核心精髓是面向对象的基本设计原则：高内聚、低耦合。要严格控制类的数量，逻辑相关度很高的，就不允许拆成多个类。不支持将来变化的部分，就不提供接口。  

组件，作为可重用的软件，不会承载太多的功能，组件的规模不会很大。因此，最理想的情况，组件就是单独的一个类。组件使用者用起来，将会是极致的简单。  

我们从网上下载开源的项目，打开源代码一看，豁！好家伙，一大堆的类和接口，不写几十个、几百个类好像就显不出作者的水平。其实真有必要写那么多的类吗？  

<code>高内聚！高内聚！单类组件，简单到极致。</code>
